# ADR-0007: Defer API Gateway to MVP2

## Status
Accepted

## Context
API Gateway provides:
- Single entry point for clients (routing, load balancing)
- Cross-cutting concerns (authentication, rate limiting, logging)
- API composition (aggregating multiple service responses)
- Protocol translation (REST to gRPC, WebSocket)

MVP1 priorities focus on **service-to-service event choreography** and SAGA validation. API Gateway adds:
- Infrastructure complexity (deploy, configure Kong/AWS API Gateway)
- Client-side complexity (authentication flow, token management)
- Additional failure point (gateway downtime impacts all services)

Deferring API Gateway allows direct service access for testing while validating core architecture.

## Decision
**Defer API Gateway to MVP2**:

**MVP1 Approach**:
- Clients (test scripts, internal tools) call **Order Service REST API directly**
- No authentication/authorization (internal testing only, trusted network)
- Each service exposes its own endpoints on different ports:
  - Order Service: `http://order-service:8080/v1/orders`
  - Payment Service: `http://payment-service:8081/v1/payments`
  - Inventory Service: `http://inventory-service:8082/v1/inventory`

**MVP2 Migration**:
- Deploy API Gateway (Kong, Spring Cloud Gateway, or AWS API Gateway)
- Route all client traffic through gateway: `https://api.example.com/orders` → Order Service
- Implement OAuth2/OIDC authentication at gateway
- Add rate limiting, request logging, and CORS policies
- Optionally implement BFF (Backend for Frontend) pattern for web/mobile clients

## Consequences

**Positive**:
- **Simplified MVP1**: No gateway infrastructure, configuration, or client auth flow
- **Faster Development**: Direct service access speeds up testing and debugging
- **Reduced Failure Points**: One less component to monitor and troubleshoot
- **Deferred Decisions**: Gateway technology choice based on actual requirements in MVP2

**Negative**:
- **Client Complexity**: Clients must know multiple service endpoints (mitigated by single Order Service entry point)
- **No Cross-Cutting Concerns**: Rate limiting, logging, auth must be duplicated per service (acceptable for MVP1)
- **Not Production-Ready**: No authentication → MVP1 for internal testing only

**Risks**:
- Service APIs designed without gateway constraints → breaking changes in MVP2 (e.g., URL structure)
- Team underestimates gateway integration complexity → MVP2 schedule slips

**Follow-ups**:
- Design REST APIs with gateway in mind (versioned URLs, consistent error formats)
- Spike API Gateway technology (Kong vs Spring Cloud Gateway) during MVP1
- Create separate ADR for gateway technology selection before MVP2
- Ensure MVP1 environments clearly marked as **non-production** (no accidental exposure)
